---
title: "Distribución Hipergeométrica"
lang: es
---

```{=html}
<style>
main.content {
text-align: justify}
</style>
```

```{r}
# ==================================================
# DISTRIBUCIÓN HIPERGEOMÉTRICA
# ==================================================
# X ~ Hypergeom(N, K, n)
# N = tamaño de la población
# K = número de éxitos en la población
# n = tamaño de la muestra
# ==================================================

# --- Ejemplo 1: Probabilidades exactas ---
# Supongamos una población de 20 piezas, 5 defectuosas.
# Se seleccionan 4 piezas sin reemplazo.
N <- 20   # población total
K <- 5    # éxitos en la población (defectuosas)
n <- 4    # tamaño de la muestra

# Probabilidad de encontrar exactamente 2 defectuosas
prob_2 <- dhyper(2, m=K, n=N-K, k=n)
cat("Probabilidad de encontrar exactamente 2 defectuosas:", round(prob_2,4), "\n")

# Probabilidad de encontrar 0, 1, 2, 3 o 4 defectuosas
x_vals <- 0:min(K,n)
probs <- dhyper(x_vals, m=K, n=N-K, k=n)
cat("Probabilidades para cada número de defectuosas:", probs, "\n")

# --- Histograma de la distribución ---
barplot(probs, names.arg=x_vals, col="#FFFF00",
        main="Distribución Hipergeométrica", xlab="Número de defectuosas", ylab="Probabilidad")

# ==================================================
# Ejemplo 2: Probabilidad acumulada
# ==================================================
# Probabilidad de encontrar al menos 2 defectuosas
P_mayor2 <- sum(dhyper(2:n, m=K, n=N-K, k=n))
cat("Probabilidad de al menos 2 defectuosas:", round(P_mayor2,4), "\n")

# ==================================================
# Ejemplo 3: Simulación de la distribución
# ==================================================
set.seed(123)
n_sim <- 10000
simulaciones <- rhyper(n_sim, m=K, n=N-K, k=n)

# Comparar histograma de simulación con la distribución teórica
hist(simulaciones, breaks=(0:(n+1))-0.5, probability=TRUE,
     col="#FFFF00", main="Simulación vs Distribución Hipergeométrica",
     xlab="Número de defectuosas", ylab="Probabilidad")
points(x_vals, probs, col="#00FF00", pch=16)
legend("topright", legend=c("Simulación","Distribución teórica"),
       col=c("#FFFF00","#00FF00"), pch=c(15,16))

# ==================================================
# Ejemplo 4: Problema propuesto
# ==================================================
# Un mazo de 52 cartas tiene 4 ases.
# Se toman 5 cartas al azar sin reemplazo.
# a) Probabilidad de obtener exactamente 1 as
# b) Probabilidad de obtener al menos 2 ases
# c) Simular 10000 manos y comparar con valores teóricos

N_cartas <- 52
K_ases <- 4
n_mano <- 5

# a) Probabilidad de 1 as
prob_1_as <- dhyper(1, m=K_ases, n=N_cartas-K_ases, k=n_mano)
cat("Probabilidad de exactamente 1 as:", round(prob_1_as,4), "\n")

# b) Probabilidad de al menos 2 ases
x_vals_cartas <- 0:min(K_ases,n_mano)
probs_cartas <- dhyper(x_vals_cartas, m=K_ases, n=N_cartas-K_ases, k=n_mano)
prob_mayor2_as <- sum(probs_cartas[3:length(probs_cartas)])  # indices 3 en adelante = 2 o más
cat("Probabilidad de al menos 2 ases:", round(prob_mayor2_as,4), "\n")

# c) Simulación de manos
set.seed(456)
sim_cartas <- rhyper(10000, m=K_ases, n=N_cartas-K_ases, k=n_mano)
hist(sim_cartas, breaks=(0:(n_mano+1))-0.5, probability=TRUE,
     col="#FFFF00", main="Simulación manos de 5 cartas", xlab="Número de ases", ylab="Probabilidad")
points(x_vals_cartas, probs_cartas, col="green", pch=16)
legend("topright", legend=c("Simulación","Distribución teórica"),
       col=c("#FFFF00","green"), pch=c(15,16))

```
```

